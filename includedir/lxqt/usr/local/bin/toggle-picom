#!/bin/bash

flags="-b"

function detect {
	 pgrep -u $UID -x picom >/dev/null
	 exitstatus=$?
}

# Check if picom-dccsillag is installed, and if that's true, change launch flags.
function check_dccsillag {
	xbps-query picom-dccsillag >/dev/null
	dccsillag=$?

	if [ ${dccsillag} = 0 ];  then
		flags="--experimental-backends -b"
	fi
}

check_dccsillag
detect

if [ $exitstatus = 0 ]; then
	echo "Stopping compositor"
	pkill picom
else
	echo "Starting compositor"
	picom ${flags}
fi
